# -*- coding: utf-8 -*-
"""
AI í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ ëª¨ë“ˆ

ğŸ¤” ì´ íŒŒì¼ì´ í•˜ëŠ” ì¼:
Gemini AIì—ê²Œ ë³´ë‚¼ ì§ˆë¬¸(í”„ë¡¬í”„íŠ¸)ë“¤ì„ ë¯¸ë¦¬ ì •ì˜í•´ë‘¡ë‹ˆë‹¤.
í”„ë¡¬í”„íŠ¸ë¥¼ í•œ ê³³ì—ì„œ ê´€ë¦¬í•˜ë©´ ë‚˜ì¤‘ì— ìˆ˜ì •í•˜ê¸° ì‰½ê³ , ì¼ê´€ëœ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ğŸ“š ë¹„ìœ :
- í”„ë¡¬í”„íŠ¸ = ì„ ìƒë‹˜ì—ê²Œ ì§ˆë¬¸í•˜ëŠ” ì§ˆë¬¸ì§€ ì–‘ì‹
- ì´ íŒŒì¼ = ì§ˆë¬¸ì§€ ì–‘ì‹ì„ ëª¨ì•„ë‘” íŒŒì¼ì² 
"""

from typing import Dict, Any


def get_comprehensive_analysis_prompt(notice_text: str) -> str:
    """
    ê³µì§€ì‚¬í•­ ì¢…í•© ë¶„ì„ì„ ìœ„í•œ í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

    ğŸ¯ ëª©ì :
    í•œ ë²ˆì˜ AI í˜¸ì¶œë¡œ ìš”ì•½, ë‚ ì§œ, ì¹´í…Œê³ ë¦¬ë¥¼ ëª¨ë‘ ì¶”ì¶œí•©ë‹ˆë‹¤.

    ğŸ”§ ë§¤ê°œë³€ìˆ˜:
    - notice_text: ë¶„ì„í•  ê³µì§€ì‚¬í•­ í…ìŠ¤íŠ¸

    ğŸ“Š ë°˜í™˜ í˜•ì‹ (JSON):
    {
        "summary": "200ì ì´ë‚´ ìš”ì•½",
        "dates": {
            "start_date": "YYYY-MM-DD",
            "end_date": "YYYY-MM-DD",
            "deadline": "YYYY-MM-DD"
        },
        "category": "í•™ì‚¬|ì¥í•™|ì·¨ì—…|í–‰ì‚¬|êµìœ¡|ê³µëª¨ì „"
    }
    """
    return f"""
ë‹¹ì‹ ì€ ëŒ€í•™êµ ê³µì§€ì‚¬í•­ ë¶„ì„ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.
ë‹¤ìŒ ê³µì§€ì‚¬í•­ì„ ë¶„ì„í•˜ì—¬ ì•„ë˜ JSON í˜•ì‹ìœ¼ë¡œë§Œ ë‹µë³€í•´ì£¼ì„¸ìš”.
ë‹¤ë¥¸ ì„¤ëª…ì€ ì¶”ê°€í•˜ì§€ ë§ê³ , ìˆœìˆ˜ JSONë§Œ ì¶œë ¥í•˜ì„¸ìš”.

**ë¶„ì„ ìš”êµ¬ì‚¬í•­:**

1. **summary** (ìš”ì•½):
   - ê³µì§€ì‚¬í•­ì˜ í•µì‹¬ ë‚´ìš©ì„ 200ì ì´ë‚´ë¡œ ìš”ì•½
   - í•™ìƒë“¤ì´ ê¼­ ì•Œì•„ì•¼ í•  ë‚´ìš© ìœ„ì£¼ë¡œ ì‘ì„±
   - ë¶ˆí•„ìš”í•œ ì¸ì‚¬ë§, ë¶€ì„œëª… ë“±ì€ ì œì™¸

2. **dates** (ë‚ ì§œ ì •ë³´):
   - start_date: í–‰ì‚¬/ì¼ì • ì‹œì‘ì¼ (YYYY-MM-DD í˜•ì‹, ì—†ìœ¼ë©´ null)
   - end_date: í–‰ì‚¬/ì¼ì • ì¢…ë£Œì¼ (YYYY-MM-DD í˜•ì‹, ì—†ìœ¼ë©´ null)
   - deadline: ì‹ ì²­/ì ‘ìˆ˜ ë§ˆê°ì¼ (YYYY-MM-DD í˜•ì‹, ì—†ìœ¼ë©´ null)
   - ë‚ ì§œê°€ "2ì›” 1ì¼", "2/1" ë“±ìœ¼ë¡œ í‘œê¸°ëœ ê²½ìš°, ì˜¬í•´ ë˜ëŠ” ê°€ì¥ ê°€ê¹Œìš´ ë¯¸ë˜ ë‚ ì§œë¡œ ë³€í™˜
   - ì—°ë„ê°€ ì—†ìœ¼ë©´ í˜„ì¬ ì—°ë„ ë˜ëŠ” ê³µì§€ì‚¬í•­ ë§¥ë½ìƒ ì ì ˆí•œ ì—°ë„ ì¶”ì •

3. **category** (ì¹´í…Œê³ ë¦¬):
   - ë‹¤ìŒ ì¤‘ í•˜ë‚˜ë§Œ ì„ íƒ: í•™ì‚¬, ì¥í•™, ì·¨ì—…, í–‰ì‚¬, êµìœ¡, ê³µëª¨ì „
   - í•™ì‚¬: ìˆ˜ê°•ì‹ ì²­, í•™ì , ì„±ì , ì¡¸ì—…, íœ´í•™, ë³µí•™ ê´€ë ¨
   - ì¥í•™: ì¥í•™ê¸ˆ, í•™ìê¸ˆ ëŒ€ì¶œ, ë“±ë¡ê¸ˆ ê´€ë ¨
   - ì·¨ì—…: ì±„ìš©, ì¸í„´ì‹­, ì·¨ì—…ë°•ëŒíšŒ ê´€ë ¨
   - í–‰ì‚¬: ì…í•™ì‹, ì¡¸ì—…ì‹, ì¶•ì œ, ì˜¤ë¦¬ì—”í…Œì´ì…˜, í•™êµ ê³µì‹ í–‰ì‚¬ ê´€ë ¨
   - êµìœ¡: íŠ¹ê°•, êµìœ¡ í”„ë¡œê·¸ë¨, ì§„ë¡œ êµìœ¡, ì›Œí¬ìˆ, ì„¸ë¯¸ë‚˜ ê´€ë ¨
   - ê³µëª¨ì „: ëŒ€íšŒ, ê²½ì§„ëŒ€íšŒ, ê³µëª¨ì „, ì½˜í…ŒìŠ¤íŠ¸ ê´€ë ¨

**JSON ì‘ë‹µ í˜•ì‹:**
```json
{{
    "summary": "ìš”ì•½ ë‚´ìš©",
    "dates": {{
        "start_date": "YYYY-MM-DD",
        "end_date": "YYYY-MM-DD",
        "deadline": "YYYY-MM-DD"
    }},
    "category": "ì¹´í…Œê³ ë¦¬ëª…"
}}
```

**ë¶„ì„í•  ê³µì§€ì‚¬í•­:**
{notice_text}

**JSON ì‘ë‹µ:**
"""


def get_summary_prompt(notice_text: str, max_length: int = 200) -> str:
    """
    ê³µì§€ì‚¬í•­ ìš”ì•½ì„ ìœ„í•œ í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

    ğŸ¯ ëª©ì :
    ê¸´ ê³µì§€ì‚¬í•­ì„ ì§§ê³  ëª…í™•í•˜ê²Œ ìš”ì•½í•©ë‹ˆë‹¤.

    ğŸ”§ ë§¤ê°œë³€ìˆ˜:
    - notice_text: ìš”ì•½í•  ê³µì§€ì‚¬í•­ í…ìŠ¤íŠ¸
    - max_length: ìµœëŒ€ ìš”ì•½ ê¸¸ì´ (ê¸°ë³¸ê°’: 200ì)
    """
    return f"""
ë‹¤ìŒ ê³µì§€ì‚¬í•­ì„ {max_length}ì ì´ë‚´ë¡œ ìš”ì•½í•´ì£¼ì„¸ìš”.

ìš”ì•½ ê°€ì´ë“œë¼ì¸:
- í•µì‹¬ ë‚´ìš©ë§Œ ê°„ê²°í•˜ê²Œ ì‘ì„±
- ë‚ ì§œ, ì¥ì†Œ, ëŒ€ìƒ ë“± ì¤‘ìš” ì •ë³´ í¬í•¨
- ë¶ˆí•„ìš”í•œ ì¸ì‚¬ë§, ë¶€ì„œëª… ì œì™¸
- í•™ìƒì´ ì·¨í•´ì•¼ í•  í–‰ë™ ì¤‘ì‹¬ìœ¼ë¡œ ì‘ì„±

ê³µì§€ì‚¬í•­:
{notice_text}

ìš”ì•½ ({max_length}ì ì´ë‚´):
"""


def get_date_extraction_prompt(notice_text: str) -> str:
    """
    ë‚ ì§œ ì •ë³´ ì¶”ì¶œì„ ìœ„í•œ í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

    ğŸ¯ ëª©ì :
    ê³µì§€ì‚¬í•­ì—ì„œ ëª¨ë“  ë‚ ì§œ ì •ë³´ë¥¼ êµ¬ì¡°í™”í•˜ì—¬ ì¶”ì¶œí•©ë‹ˆë‹¤.

    ğŸ“Š ë°˜í™˜ í˜•ì‹ (JSON):
    {
        "start_date": "YYYY-MM-DD",
        "end_date": "YYYY-MM-DD",
        "deadline": "YYYY-MM-DD"
    }
    """
    return f"""
ë‹¤ìŒ ê³µì§€ì‚¬í•­ì—ì„œ ë‚ ì§œ ì •ë³´ë¥¼ ì¶”ì¶œí•˜ì—¬ JSON í˜•ì‹ìœ¼ë¡œ ë‹µë³€í•´ì£¼ì„¸ìš”.

**ì¶”ì¶œ ê·œì¹™:**
- start_date: í–‰ì‚¬ë‚˜ ì¼ì •ì´ ì‹œì‘ë˜ëŠ” ë‚ ì§œ
- end_date: í–‰ì‚¬ë‚˜ ì¼ì •ì´ ëë‚˜ëŠ” ë‚ ì§œ
- deadline: ì‹ ì²­, ì ‘ìˆ˜, ì œì¶œ ë§ˆê°ì¼
- ë‚ ì§œê°€ ì—†ìœ¼ë©´ nullë¡œ í‘œì‹œ
- ì—°ë„ê°€ ì—†ëŠ” ê²½ìš°, í˜„ì¬ ì—°ë„ ë˜ëŠ” ê°€ì¥ ê°€ê¹Œìš´ ë¯¸ë˜ ë‚ ì§œë¡œ ì¶”ì •
- ëª¨ë“  ë‚ ì§œëŠ” YYYY-MM-DD í˜•ì‹ìœ¼ë¡œ ë³€í™˜

**JSON ì‘ë‹µ í˜•ì‹:**
```json
{{
    "start_date": "YYYY-MM-DD",
    "end_date": "YYYY-MM-DD",
    "deadline": "YYYY-MM-DD"
}}
```

**ê³µì§€ì‚¬í•­:**
{notice_text}

**JSON ì‘ë‹µ:**
"""


def get_category_prompt(notice_text: str) -> str:
    """
    ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜ë¥¼ ìœ„í•œ í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

    ğŸ¯ ëª©ì :
    ê³µì§€ì‚¬í•­ì„ ì •í™•í•œ ì¹´í…Œê³ ë¦¬ë¡œ ë¶„ë¥˜í•©ë‹ˆë‹¤.

    ğŸ·ï¸ ì¹´í…Œê³ ë¦¬:
    - í•™ì‚¬: ìˆ˜ê°•ì‹ ì²­, í•™ì , ì„±ì , ì¡¸ì—… ê´€ë ¨
    - ì¥í•™: ì¥í•™ê¸ˆ, í•™ìê¸ˆ ëŒ€ì¶œ ê´€ë ¨
    - ì·¨ì—…: ì±„ìš©, ì¸í„´ì‹­, ì·¨ì—…ë°•ëŒíšŒ ê´€ë ¨
    - í–‰ì‚¬: ì…í•™ì‹, ì¡¸ì—…ì‹, ì¶•ì œ, ì˜¤ë¦¬ì—”í…Œì´ì…˜ ê´€ë ¨
    - êµìœ¡: íŠ¹ê°•, êµìœ¡ í”„ë¡œê·¸ë¨, ì§„ë¡œ êµìœ¡, ì„¸ë¯¸ë‚˜ ê´€ë ¨
    - ê³µëª¨ì „: ëŒ€íšŒ, ê²½ì§„ëŒ€íšŒ, ê³µëª¨ì „ ê´€ë ¨
    """
    return f"""
ë‹¤ìŒ ê³µì§€ì‚¬í•­ì„ ì•„ë˜ ì¹´í…Œê³ ë¦¬ ì¤‘ í•˜ë‚˜ë¡œ ë¶„ë¥˜í•´ì£¼ì„¸ìš”.

**ì¹´í…Œê³ ë¦¬ ëª©ë¡:**
- í•™ì‚¬: ìˆ˜ê°•ì‹ ì²­, í•™ì , ì„±ì , ì¡¸ì—…, íœ´í•™, ë³µí•™ ê´€ë ¨
- ì¥í•™: ì¥í•™ê¸ˆ, í•™ìê¸ˆ ëŒ€ì¶œ, ë“±ë¡ê¸ˆ ê´€ë ¨
- ì·¨ì—…: ì±„ìš©, ì¸í„´ì‹­, ì·¨ì—…ë°•ëŒíšŒ ê´€ë ¨
- í–‰ì‚¬: ì…í•™ì‹, ì¡¸ì—…ì‹, ì¶•ì œ, ì˜¤ë¦¬ì—”í…Œì´ì…˜, í•™êµ ê³µì‹ í–‰ì‚¬ ê´€ë ¨
- êµìœ¡: íŠ¹ê°•, êµìœ¡ í”„ë¡œê·¸ë¨, ì§„ë¡œ êµìœ¡, ì›Œí¬ìˆ, ì„¸ë¯¸ë‚˜ ê´€ë ¨
- ê³µëª¨ì „: ëŒ€íšŒ, ê²½ì§„ëŒ€íšŒ, ê³µëª¨ì „, ì½˜í…ŒìŠ¤íŠ¸ ê´€ë ¨

ì¹´í…Œê³ ë¦¬ ì´ë¦„ë§Œ ì •í™•íˆ ë‹µí•´ì£¼ì„¸ìš”. (ì˜ˆ: í•™ì‚¬)

**ê³µì§€ì‚¬í•­:**
{notice_text}

**ì¹´í…Œê³ ë¦¬:**
"""




def get_keywords_prompt(notice_text: str, max_keywords: int = 5) -> str:
    """
    í•µì‹¬ í‚¤ì›Œë“œ ì¶”ì¶œì„ ìœ„í•œ í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

    ğŸ¯ ëª©ì :
    ê³µì§€ì‚¬í•­ì—ì„œ ê°€ì¥ ì¤‘ìš”í•œ í‚¤ì›Œë“œë¥¼ ì¶”ì¶œí•©ë‹ˆë‹¤.

    ğŸ”§ ë§¤ê°œë³€ìˆ˜:
    - notice_text: í‚¤ì›Œë“œë¥¼ ì¶”ì¶œí•  í…ìŠ¤íŠ¸
    - max_keywords: ìµœëŒ€ í‚¤ì›Œë“œ ê°œìˆ˜ (ê¸°ë³¸ê°’: 5ê°œ)
    """
    return f"""
ë‹¤ìŒ ê³µì§€ì‚¬í•­ì—ì„œ í•µì‹¬ í‚¤ì›Œë“œë¥¼ ìµœëŒ€ {max_keywords}ê°œ ì¶”ì¶œí•´ì£¼ì„¸ìš”.

**í‚¤ì›Œë“œ ì¶”ì¶œ ê°€ì´ë“œ:**
- ê³µì§€ì‚¬í•­ì˜ ì£¼ì œë¥¼ ëŒ€í‘œí•˜ëŠ” ë‹¨ì–´ ì„ íƒ
- ê³ ìœ ëª…ì‚¬, ë‚ ì§œ, ì¥ì†Œ ë“± êµ¬ì²´ì  ì •ë³´ ìš°ì„ 
- í•™ìƒë“¤ì´ ê²€ìƒ‰í•  ë§Œí•œ ë‹¨ì–´ ìœ„ì£¼
- ë¶ˆí•„ìš”í•œ ì¡°ì‚¬, ì–´ë¯¸ ì œê±°

í‚¤ì›Œë“œëŠ” ì‰¼í‘œ(,)ë¡œ êµ¬ë¶„í•´ì„œ ë‚˜ì—´í•´ì£¼ì„¸ìš”.
ì˜ˆ: ìˆ˜ê°•ì‹ ì²­, 1í•™ê¸°, 2ì›” 1ì¼, í•™ë…„ë³„ ì¼ì •

**ê³µì§€ì‚¬í•­:**
{notice_text}

**í•µì‹¬ í‚¤ì›Œë“œ:**
"""


def get_schedule_extraction_prompt(notice_text: str) -> str:
    """
    ìƒì„¸ ì¼ì • ì¶”ì¶œì„ ìœ„í•œ í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

    ğŸ¯ ëª©ì :
    ê³µì§€ì‚¬í•­ì—ì„œ ëª¨ë“  ì¼ì •ì„ ì‹œê°„ê¹Œì§€ í¬í•¨í•˜ì—¬ ì¶”ì¶œí•©ë‹ˆë‹¤.

    ğŸ“Š ë°˜í™˜ í˜•ì‹ (JSON):
    {
        "schedules": [
            {
                "event_name": "ì´ë²¤íŠ¸ëª…",
                "start_date": "YYYY-MM-DD",
                "start_time": "HH:MM",
                "end_date": "YYYY-MM-DD",
                "end_time": "HH:MM",
                "description": "ì„¤ëª…"
            }
        ]
    }
    """
    return f"""
ë‹¤ìŒ ê³µì§€ì‚¬í•­ì—ì„œ ë‚ ì§œì™€ ì¼ì • ì •ë³´ë¥¼ ëª¨ë‘ ì¶”ì¶œí•´ì£¼ì„¸ìš”.

**ì¤‘ìš”**: ë°˜ë“œì‹œ ì•„ë˜ JSON í˜•ì‹ìœ¼ë¡œë§Œ ë‹µë³€í•´ì£¼ì„¸ìš”. ë‹¤ë¥¸ ì„¤ëª…ì€ ì¶”ê°€í•˜ì§€ ë§ˆì„¸ìš”.

**ì¶”ì¶œ ê·œì¹™:**
- í•™ë…„ë³„, ëŒ€ìƒë³„ë¡œ ì¼ì •ì´ ë‹¤ë¥´ë©´ ê°ê° ë³„ë„ì˜ ì´ë²¤íŠ¸ë¡œ ì¶”ì¶œ
- ì‹œê°„ì´ ëª…ì‹œë˜ì§€ ì•Šì€ ê²½ìš° nullë¡œ í‘œì‹œ
- ì¢…ë£Œì¼/ì‹œê°„ì´ ì—†ìœ¼ë©´ ì‹œì‘ì¼/ì‹œê°„ê³¼ ë™ì¼í•˜ê²Œ ì„¤ì •
- ë‚ ì§œëŠ” YYYY-MM-DD, ì‹œê°„ì€ HH:MM í˜•ì‹ ì‚¬ìš©

**JSON ì‘ë‹µ í˜•ì‹:**
```json
{{
    "schedules": [
        {{
            "event_name": "ì´ë²¤íŠ¸ ì´ë¦„",
            "start_date": "YYYY-MM-DD",
            "start_time": "HH:MM",
            "end_date": "YYYY-MM-DD",
            "end_time": "HH:MM",
            "description": "ê°„ë‹¨í•œ ì„¤ëª…"
        }}
    ]
}}
```

**ê³µì§€ì‚¬í•­:**
{notice_text}

**JSON ì‘ë‹µ:**
"""


# í”„ë¡¬í”„íŠ¸ ì„¤ì • ìƒìˆ˜
PROMPT_CONFIG = {
    "temperature": {
        "comprehensive": 0.2,  # ì¢…í•© ë¶„ì„ (ì¼ê´€ì„± ì¤‘ìš”)
        "summary": 0.3,        # ìš”ì•½ (ì•½ê°„ì˜ ì°½ì˜ì„±)
        "extraction": 0.1,     # ì •ë³´ ì¶”ì¶œ (ì •í™•ì„± ìµœìš°ì„ )
        "classification": 0.0, # ë¶„ë¥˜ (ì™„ì „ ì¼ê´€ì„±)
    },
    "max_tokens": {
        "comprehensive": 2048,
        "summary": 512,
        "extraction": 1024,
        "classification": 256,
    }
}


def get_prompt_config(prompt_type: str) -> Dict[str, Any]:
    """
    í”„ë¡¬í”„íŠ¸ íƒ€ì…ì— ë”°ë¥¸ ì„¤ì •ì„ ë°˜í™˜í•©ë‹ˆë‹¤.

    ğŸ”§ ë§¤ê°œë³€ìˆ˜:
    - prompt_type: í”„ë¡¬í”„íŠ¸ ì¢…ë¥˜ (comprehensive, summary, extraction, classification)

    ğŸ“Š ë°˜í™˜ê°’:
    {"temperature": float, "max_tokens": int}
    """
    return {
        "temperature": PROMPT_CONFIG["temperature"].get(prompt_type, 0.3),
        "max_tokens": PROMPT_CONFIG["max_tokens"].get(prompt_type, 1024),
    }


# ğŸ§ª í…ŒìŠ¤íŠ¸ ì½”ë“œ
def get_user_relevance_prompt(
    notice_summary: str,
    notice_category: str,
    user_profile: Dict[str, Any]
) -> str:
    """
    ì‚¬ìš©ìë³„ ê³µì§€ì‚¬í•­ ê´€ë ¨ë„ë¥¼ ê³„ì‚°í•˜ëŠ” í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

    ğŸ¯ ëª©ì :
    ì‚¬ìš©ìì˜ í•™ê³¼, í•™ë…„, ê´€ì‹¬ í‚¤ì›Œë“œ ë“±ì„ ê³ ë ¤í•˜ì—¬ ê³µì§€ì‚¬í•­ê³¼ì˜ ê´€ë ¨ë„ë¥¼ 0~1 ì ìˆ˜ë¡œ ê³„ì‚°í•©ë‹ˆë‹¤.

    ğŸ”§ ë§¤ê°œë³€ìˆ˜:
    - notice_summary: ê³µì§€ì‚¬í•­ ìš”ì•½
    - notice_category: ê³µì§€ì‚¬í•­ ì¹´í…Œê³ ë¦¬ (í•™ì‚¬, ì¥í•™, ì·¨ì—… ë“±)
    - user_profile: ì‚¬ìš©ì ì •ë³´
      {
          "department": "ì»´í“¨í„°ì •ë³´ê³µí•™ê³¼",
          "grade": 3,
          "interests": ["AI", "ì›¹ê°œë°œ", "ì¥í•™ê¸ˆ"],
          "student_type": "ì¬í•™ìƒ|íœ´í•™ìƒ|ì¡¸ì—…ìƒ"
      }

    ğŸ“Š ë°˜í™˜ í˜•ì‹ (JSON):
    {
        "relevance_score": 0.85,
        "reason": "í•™ê³¼ì™€ ê´€ì‹¬ì‚¬ì— ë§¤ìš° ê´€ë ¨ë¨",
        "action_required": true
    }

    ğŸ’¡ ê´€ë ¨ë„ ì ìˆ˜ ê¸°ì¤€:
    - 0.8 ~ 1.0: ë§¤ìš° ê´€ë ¨ ë†’ìŒ (í•„ìˆ˜ í™•ì¸, í‘¸ì‹œ ì•Œë¦¼ ë°œì†¡)
    - 0.5 ~ 0.8: ê´€ë ¨ ìˆìŒ (ì¼ë°˜ ì•Œë¦¼)
    - 0.2 ~ 0.5: ì•½ê°„ ê´€ë ¨ë¨ (ì•Œë¦¼ ì—†ì´ ëª©ë¡ì—ë§Œ í‘œì‹œ)
    - 0.0 ~ 0.2: ê´€ë ¨ ì—†ìŒ (ìˆ¨ê¹€)
    """
    # ì‚¬ìš©ì ì •ë³´ ì¶”ì¶œ
    department = user_profile.get("department", "ì •ë³´ ì—†ìŒ")
    grade = user_profile.get("grade", "ì •ë³´ ì—†ìŒ")
    interests = user_profile.get("interests", [])
    student_type = user_profile.get("student_type", "ì¬í•™ìƒ")

    interests_str = ", ".join(interests) if interests else "ì„¤ì • ì•ˆ ë¨"

    return f"""
ë‹¹ì‹ ì€ ëŒ€í•™ ê³µì§€ì‚¬í•­ ì¶”ì²œ ì‹œìŠ¤í…œì˜ ê´€ë ¨ë„ ë¶„ì„ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.
ë‹¤ìŒ ê³µì§€ì‚¬í•­ì´ ì‚¬ìš©ìì—ê²Œ ì–¼ë§ˆë‚˜ ê´€ë ¨ì´ ìˆëŠ”ì§€ ë¶„ì„í•˜ì—¬ JSON í˜•ì‹ìœ¼ë¡œ ë‹µë³€í•´ì£¼ì„¸ìš”.

**ì‚¬ìš©ì ì •ë³´:**
- í•™ê³¼: {department}
- í•™ë…„: {grade}í•™ë…„
- í•™ìƒ ìœ í˜•: {student_type}
- ê´€ì‹¬ í‚¤ì›Œë“œ: {interests_str}

**ê³µì§€ì‚¬í•­ ì •ë³´:**
- ì¹´í…Œê³ ë¦¬: {notice_category}
- ìš”ì•½: {notice_summary}

**ë¶„ì„ ê¸°ì¤€:**

1. **relevance_score** (ê´€ë ¨ë„ ì ìˆ˜, 0~1):
   - 1.0: í•™ê³¼/í•™ë…„ ëŒ€ìƒ í•„ìˆ˜ ê³µì§€ (ì˜ˆ: í•´ë‹¹ í•™ê³¼ ìˆ˜ê°•ì‹ ì²­, ì¡¸ì—…ìš”ê±´)
   - 0.8: ê´€ì‹¬ì‚¬ ì§ì ‘ ê´€ë ¨ (ì˜ˆ: ê´€ì‹¬ í‚¤ì›Œë“œ 'ì¥í•™ê¸ˆ' â†’ ì¥í•™ê¸ˆ ê³µì§€)
   - 0.6: ì „ì²´ í•™ìƒ ëŒ€ìƒ ì¤‘ìš” ê³µì§€ (ì˜ˆ: ë“±ë¡ê¸ˆ ë‚©ë¶€, í•™ì‚¬ì¼ì •)
   - 0.4: ê°„ì ‘ì  ê´€ë ¨ (ì˜ˆ: íƒ€ í•™ê³¼ì´ì§€ë§Œ ìœµí•© í”„ë¡œê·¸ë¨)
   - 0.2: ì•½ê°„ ê´€ë ¨ (ì˜ˆ: ì „ì²´ ê³µì§€ì´ì§€ë§Œ ì„ íƒ ì‚¬í•­)
   - 0.0: ë¬´ê´€ (ì˜ˆ: íƒ€ í•™ê³¼ ì „ìš© ê³µì§€, ì¡¸ì—…ìƒ ëŒ€ìƒì´ì§€ë§Œ ì¬í•™ìƒ)

2. **reason** (ê´€ë ¨ë„ ì´ìœ ):
   - ì™œ ì´ ì ìˆ˜ë¥¼ ë¶€ì—¬í–ˆëŠ”ì§€ ê°„ë‹¨íˆ ì„¤ëª… (50ì ì´ë‚´)

3. **action_required** (ì¡°ì¹˜ í•„ìš” ì—¬ë¶€):
   - true: ì‚¬ìš©ìê°€ ì§ì ‘ í–‰ë™í•´ì•¼ í•¨ (ì‹ ì²­, ì œì¶œ, ì°¸ì—¬ ë“±)
   - false: ë‹¨ìˆœ ì •ë³´ì„± ê³µì§€

**íŠ¹ë³„ ê·œì¹™:**
- íœ´í•™ìƒì€ í•™ì  ê´€ë ¨ ê³µì§€ë§Œ ë†’ì€ ì ìˆ˜ (ë³µí•™, íœ´í•™ ì—°ì¥ ë“±)
- ì¡¸ì—…ìƒì€ ì¡¸ì—…/ì·¨ì—… ê´€ë ¨ ê³µì§€ë§Œ ë†’ì€ ì ìˆ˜
- "ì „ì²´", "ì „ê³µ", "ì „ í•™ë…„" í‚¤ì›Œë“œê°€ ìˆìœ¼ë©´ ê¸°ë³¸ 0.6ì  ì´ìƒ
- ì¹´í…Œê³ ë¦¬ì™€ ê´€ì‹¬ì‚¬ê°€ ì¼ì¹˜í•˜ë©´ +0.2ì  ê°€ì‚°

**JSON ì‘ë‹µ í˜•ì‹:**
```json
{{
    "relevance_score": 0.85,
    "reason": "ì»´í“¨í„°ê³µí•™ê³¼ AI ê´€ë ¨ ê³µëª¨ì „",
    "action_required": true
}}
```

**JSON ì‘ë‹µ:**
"""


def get_batch_relevance_prompt(
    notices: list,
    user_profile: Dict[str, Any]
) -> str:
    """
    ì—¬ëŸ¬ ê³µì§€ì‚¬í•­ì— ëŒ€í•œ ê´€ë ¨ë„ë¥¼ í•œ ë²ˆì— ê³„ì‚°í•˜ëŠ” í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

    ğŸ¯ ëª©ì :
    API í˜¸ì¶œ íšŸìˆ˜ë¥¼ ì¤„ì´ê¸° ìœ„í•´ ì—¬ëŸ¬ ê³µì§€ì‚¬í•­ì„ í•œ ë²ˆì— ë¶„ì„í•©ë‹ˆë‹¤.

    ğŸ”§ ë§¤ê°œë³€ìˆ˜:
    - notices: ê³µì§€ì‚¬í•­ ë¦¬ìŠ¤íŠ¸ (ìµœëŒ€ 10ê°œ ê¶Œì¥)
      [
          {"id": "1", "summary": "...", "category": "í•™ì‚¬"},
          {"id": "2", "summary": "...", "category": "ì¥í•™"}
      ]
    - user_profile: ì‚¬ìš©ì ì •ë³´

    ğŸ“Š ë°˜í™˜ í˜•ì‹ (JSON):
    {
        "results": [
            {"notice_id": "1", "relevance_score": 0.9, "reason": "...", "action_required": true},
            {"notice_id": "2", "relevance_score": 0.5, "reason": "...", "action_required": false}
        ]
    }
    """
    department = user_profile.get("department", "ì •ë³´ ì—†ìŒ")
    grade = user_profile.get("grade", "ì •ë³´ ì—†ìŒ")
    interests = user_profile.get("interests", [])
    student_type = user_profile.get("student_type", "ì¬í•™ìƒ")

    interests_str = ", ".join(interests) if interests else "ì„¤ì • ì•ˆ ë¨"

    # ê³µì§€ì‚¬í•­ ë¦¬ìŠ¤íŠ¸ í¬ë§·íŒ…
    notices_text = ""
    for notice in notices[:10]:  # ìµœëŒ€ 10ê°œë§Œ ì²˜ë¦¬
        notices_text += f"""
[ê³µì§€ {notice.get('id', 'unknown')}]
- ì¹´í…Œê³ ë¦¬: {notice.get('category', 'í•™ì‚¬')}
- ìš”ì•½: {notice.get('summary', '')[:150]}
"""

    return f"""
ë‹¹ì‹ ì€ ëŒ€í•™ ê³µì§€ì‚¬í•­ ì¶”ì²œ ì‹œìŠ¤í…œì˜ ê´€ë ¨ë„ ë¶„ì„ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.
ì•„ë˜ ì—¬ëŸ¬ ê³µì§€ì‚¬í•­ì´ ì‚¬ìš©ìì—ê²Œ ì–¼ë§ˆë‚˜ ê´€ë ¨ì´ ìˆëŠ”ì§€ ê°ê° ë¶„ì„í•˜ì—¬ JSON ë°°ì—´ í˜•ì‹ìœ¼ë¡œ ë‹µë³€í•´ì£¼ì„¸ìš”.

**ì‚¬ìš©ì ì •ë³´:**
- í•™ê³¼: {department}
- í•™ë…„: {grade}í•™ë…„
- í•™ìƒ ìœ í˜•: {student_type}
- ê´€ì‹¬ í‚¤ì›Œë“œ: {interests_str}

**ê³µì§€ì‚¬í•­ ëª©ë¡:**
{notices_text}

**ë¶„ì„ ê¸°ì¤€:**
- relevance_score: 0~1 ì‚¬ì´ ì ìˆ˜ (1.0 = ë§¤ìš° ê´€ë ¨, 0.0 = ë¬´ê´€)
- reason: ê´€ë ¨ë„ ì´ìœ  (50ì ì´ë‚´)
- action_required: ì¡°ì¹˜ í•„ìš” ì—¬ë¶€ (true/false)

**JSON ì‘ë‹µ í˜•ì‹:**
```json
{{
    "results": [
        {{"notice_id": "1", "relevance_score": 0.9, "reason": "í•™ê³¼ í•„ìˆ˜ ê³µì§€", "action_required": true}},
        {{"notice_id": "2", "relevance_score": 0.5, "reason": "ì „ì²´ ê³µì§€", "action_required": false}}
    ]
}}
```

**JSON ì‘ë‹µ:**
"""


if __name__ == "__main__":
    print("=" * 50)
    print("ğŸ§ª í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ í…ŒìŠ¤íŠ¸")
    print("=" * 50)

    # í…ŒìŠ¤íŠ¸ ê³µì§€ì‚¬í•­
    test_notice = """
    [í•™ì‚¬ê³µì§€] 2024í•™ë…„ë„ 1í•™ê¸° ìˆ˜ê°•ì‹ ì²­ ì•ˆë‚´

    ìˆ˜ê°•ì‹ ì²­ ì¼ì •ì„ ë‹¤ìŒê³¼ ê°™ì´ ì•ˆë‚´í•©ë‹ˆë‹¤.
    - 4í•™ë…„: 2024ë…„ 2ì›” 1ì¼ 10:00 ~ 2ì›” 2ì¼ 18:00
    - 3í•™ë…„: 2024ë…„ 2ì›” 2ì¼ 10:00 ~ 2ì›” 3ì¼ 18:00

    í•™ìƒì§€ì›ì²˜ í•™ì‚¬ìš´ì˜íŒ€
    """

    print("\n1. ì¢…í•© ë¶„ì„ í”„ë¡¬í”„íŠ¸:")
    print("-" * 50)
    prompt = get_comprehensive_analysis_prompt(test_notice)
    print(prompt[:300] + "...\n")

    print("\n2. ìš”ì•½ í”„ë¡¬í”„íŠ¸:")
    print("-" * 50)
    prompt = get_summary_prompt(test_notice, 100)
    print(prompt[:200] + "...\n")

    print("\n3. ë‚ ì§œ ì¶”ì¶œ í”„ë¡¬í”„íŠ¸:")
    print("-" * 50)
    prompt = get_date_extraction_prompt(test_notice)
    print(prompt[:200] + "...\n")

    print("\n4. í”„ë¡¬í”„íŠ¸ ì„¤ì •:")
    print("-" * 50)
    config = get_prompt_config("comprehensive")
    print(f"Temperature: {config['temperature']}")
    print(f"Max Tokens: {config['max_tokens']}")

    print("\n" + "=" * 50)
    print("âœ… í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ í…ŒìŠ¤íŠ¸ ì™„ë£Œ!")
    print("=" * 50)
